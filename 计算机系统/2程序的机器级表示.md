# 程序的机器级表示
我们使用高级语言编程的时候，机器屏蔽了程序的细节，即机器级的实现。优点在于，用高级语言编写的程序可以在很多不同的机器上编译和执行，而汇编代码则是与特定机器密切相关的。而且，在这种抽象级别上工作效率会更高，也更可靠（编译器提供的类型检查能帮助我们发现许多程序错误）。

计算机执行机器代码，用字节序列编码低级的操作，包括处理数据、管理内存、读写存储设备上的数据、利用网络通信等。编译器基于编程语言的规则、目标机器的指令集和操作系统遵循的惯例，经过一系列的阶段生成机器代码。

比如 _hello.c_ 程序，为了能在系统上运行，每条C语句都必须被其他程序转化为一系列的低级机器语言指令。然后这些指令按照一种称为 _可执行目标程序/文件_ 的格式打好包，并以二进制磁盘文件的形式存放起来。

在Unix系统上，这个转化的命令是`gcc -o hello hello.c`。`gcc`编译器将 _hello.c_ 翻译成了一个可执行文件 _hello_。

这个翻译过程可分为四个阶段：
 1. __预处理阶段__。预处理器(cpp)根据以字符#开头的命令，修改原始的C程序，比如读取系统头文件内容等。结果得到修改了的源程序 _hello.i_。
 2. __编译阶段__。编译器（cc1）将 _hello.i_ 翻译成汇编程序 _hello.s_。汇编语言为不同高级语言的不同编译器提供了通用的输出语言。这一过程包括分词分析、语法分析、遍历分析、代码生成。
 3. __汇编阶段__。接下来汇编器（as）将 _hello.s_ 翻译成机器语言指令，把这些指令打包成 _可重定位目标程序_ 的格式，并保存到目标文件 _hello.o_。
 4. __链接阶段__。比如hello程序调用了`printf`函数，而`printf`函数存在于`printf.o`，一个存在于预编译标准C库的文件中，而这个文件必须合并到 _hello.o_中。链接器（ld）就负责处理这种合并。结果得到 _hello_ 文件。它是一个可执行文件，可以被加载到内存中，由系统执行。
